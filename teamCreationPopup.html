<DOCTYPE HTML5>
    <html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>TOAST UI Calendar App - Team Creation Page</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.css">
        <link rel="stylesheet" type="text/css" href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css">
        <link rel="stylesheet" type="text/css" href="./dist/tui-calendar.css">
        <link rel="stylesheet" type="text/css" href="./src/css/default.css">
        <link rel="stylesheet" type="text/css" href="./src/css/icons.css">
        <link rel="stylesheet" type="text/css" href="./src/css/login.css">
        <script src="./src/index.js"></script>
        <style>
            #addbtn { 
                position:absolute;
                left: 90%; 
                bottom: 51%;
                width:9.5%;
                height:7%;
                cursor: pointer;
            }
        </style>
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
        <script src="https://uicdn.toast.com/tui.code-snippet/v1.5.2/tui-code-snippet.min.js"></script>
        <script src="https://uicdn.toast.com/tui.time-picker/v2.0.3/tui-time-picker.min.js"></script>
        <script src="https://uicdn.toast.com/tui.date-picker/v4.0.3/tui-date-picker.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chance/1.0.13/chance.min.js"></script>
        <!-- <script src="./js/theme/dooray.js"></script> -->
        <script src="./src/app.js"></script>
        <script>
            $.fn.serializeObject = function() {
                var obj = {};
                $.each(this.serializeArray(), function(i, o) {
                    var n = o.name, v = o.value;
                    obj[n] = obj[n] === undefined ? v
                        : $.isArray(obj[n]) ? obj[n].concat(v)
                            : [obj[n], v];
                });
                return obj;
            };
            const add_textbox = () => {
                const box = document.getElementById("textBox");
                const newP = document.createElement('p');
                newP.innerHTML = '<div class=\'teamAddNew\'><div id=\'textBox\' class=\'teamAddNew\'><input type=\'text\' name=\'teamMember\' class=\'teamAdd\' placeholder=\'초대할 팀원의 이메일 입력\'></div></div>';
                box.appendChild(newP);
            };
            const remove = (obj) => {
                document.getElementById('box').removeChild(obj.parentNode);
            };
            const submit_team = () => {
                let form = $('#teamForm').serializeObject();
                if (!form.teamName) {
                    window.alert('please input team name');
                    return;
                }
                form.teamMember = Array.isArray(form.teamMember) ? form.teamMember : [form.teamMember];
                for (var i = 0; i < form.teamMember.length; i++) {
                    if (!/^[A-Za-zd0-9]+([-_.][A-Za-zd]+)*@([A-Za-zd]+[-.])+[A-Za-zd]{2,5}$/.test(form.teamMember[i])) {
                        window.alert('please input right email address');
                        return false;
                    }
                }
                request.post('/team', form).then(function(res) {
                    window.alert(res.data.msg);
                    window.close();
                }).catch(function({response}) {
                    let msg = response.data.msg;
                    window.alert(msg);
                });
            };
        </script>
    </head>
    <body>
        <div id="top">
            <img src="./src/css/image/img-bi.png" srcset="./src/css/image/img-bi@2x.png 2x,./src/css/image/img-bi@3x.png 3x" onClick="window.location.href = '/index.html'">
            <button id="btn-login" class="btn btn-default btn-login" type="button" style="display: none;">Login</button>
            <button id="btn-logout" class="btn btn-default btn-login" type="button" style="display: none;">Logout</button>
        </div>
        <div id="lnb">
            <div id="lnb-calendars" class="lnb-calendars">
                    <button class="btn-team-category" onclick="window.location.reload()" class="team-schedule-1">
                        팀 생성
                    </button>
                <button class="btn-team-category" onclick="teamPopup()">
                    <script type="text/javascript" src="./src/js/view/popup/teamWorkPopup.js"></script>
                    팀 할일 생성
                </button>
            </div>
            <div class="lnb-footer">
                © NHN Corp.
            </div>
        </div>
        <div id="right">
            <div id="menu">
            </div>
            <div class="teamBox">
                <form id="teamForm" action="#" method="post" class="loginForm" onsubmit="return false;">
                    <h2><b>Team Creation</b></h2>
                    <div class="teamNameForm">
                        <div class='teamNameForm2'>
                            <input type='text' class='teamName' placeholder='생성할 팀 이름 입력' >
                        </div>
                    </div>
                    <div class="teamAddForm">
                        <div class="teamAddForm2">
                            <input type="text" class="teamAdd" placeholder="초대할 팀원의 이메일 입력" >
                        </div>
                        <div id="textBox">
                            <image type="button" id="addbtn" src="./src/css/image/free-icon-add-button-4601618.png" style="opacity: 1" onclick="add_textbox()"></image>  
                        </div> 
                    </div>
                    <button type="button" class="btn" onclick="submit_team()">
                        SAVE
                    </button>
                </form>
            </div>
        </div>
    </body>
</html>